# Global Rules (V3.1)

## Core Philosophy
1. RECON 先完成机器扫描；AUDIT 阶段由 LLM 自主选择工具深挖。
2. 结论必须可复核（至少有 `file:line` 证据）。
3. 发现一个模式后必须做同类扩散搜索。
4. 覆盖优先于格式，最终以 gate 结果判定可交付性。
5. 以 `audit/` 产物为单一事实源。

## Output Protocol
- 状态更新简短，详细证据放在 `audit/`。
- 用户中文输入时，报告输出中文。
- AUDIT 输出允许半结构化 markdown；最终交付必须结构化产物齐全。

## Mandatory Artifacts
- RECON: `audit/inventory.jsonl`, `audit/attack-surface.jsonl`
- AUDIT: `audit/findings.md`
- HARDEN: `audit/findings.jsonl`, `audit/chains.json`, `audit/verdict.json`, `audit/coverage.json`, `audit/report.md`
- Optional navigation: `audit/codeelements.jsonl`, `audit/edges.jsonl`, `audit/sources_sinks.jsonl`, `audit/data_catalog.jsonl`, `audit/anomalies.jsonl`, `audit/must_investigate.jsonl`

## Gate Discipline
- Gate fail-closed by `scripts/gate.py`.
- `G0` after RECON, `G1` before final delivery.
- `report.md` must be generated by `scripts/compile_report.py`.
